package com.example.john.myapplication.activity;import android.database.sqlite.SQLiteOpenHelper;import android.graphics.drawable.Drawable;import android.os.Bundle;import android.support.design.widget.TabLayout;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentStatePagerAdapter;import android.support.v4.content.ContextCompat;import android.support.v4.view.PagerAdapter;import android.support.v4.view.ViewPager;import android.support.v7.app.AppCompatActivity;import android.text.Spannable;import android.text.SpannableString;import android.text.style.ImageSpan;import android.view.LayoutInflater;import android.view.View;import android.widget.ImageView;import com.example.john.myapplication.db.MyDatabaseHelper;import com.example.john.myapplication.fragment.FirstFragment;import com.example.john.myapplication.fragment.SecondFragment;import com.example.john.myapplication.fragment.ThirdFragment;import java.util.ArrayList;import java.util.List;public class MainActivity extends AppCompatActivity {    private PagerAdapter pagerAdapter;    private  ViewPager viewPager;    private int[] images = new int[]{R.mipmap.icon11, R.mipmap.icon21, R.mipmap.icon31, R.mipmap.icon12, R.mipmap.icon22, R.mipmap.icon32};    private TabLayout tabLayout;    private SQLiteOpenHelper sqLiteOpenHelper ;    @Override    protected void onRestart() {        tabLayout.setupWithViewPager(viewPager);        pagerAdapter.notifyDataSetChanged();        super.onRestart();    }    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        initData();        initView();        initTabLayout();        initDB();    }    private void initData(){        final List<Fragment> fragments = new ArrayList<Fragment>();        Fragment fragment1 = new FirstFragment();        Fragment fragment2 = new SecondFragment();        Fragment fragment3 = new ThirdFragment();        fragments.add(fragment1);        fragments.add(fragment2);        fragments.add(fragment3);        pagerAdapter = new FragmentStatePagerAdapter(getSupportFragmentManager()) {            @Override            public Fragment getItem(int position) {                return fragments.get(position);            }            @Override            public int getCount() {                return fragments.size();            }            @Override            public CharSequence getPageTitle(int position) {                Drawable drawable;                switch (position) {                    case 0:                        drawable = ContextCompat.getDrawable(MainActivity.this, R.mipmap.icon12);                        break;                    case 1:                        drawable = ContextCompat.getDrawable(MainActivity.this, R.mipmap.icon22);                        break;                    case 2:                        drawable = ContextCompat.getDrawable(MainActivity.this, R.mipmap.icon32);                        break;                    default:                        drawable = ContextCompat.getDrawable(MainActivity.this, R.mipmap.icon32);                        break;                }                drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());                ImageSpan imageSpan = new ImageSpan(drawable, ImageSpan.ALIGN_BOTTOM);                SpannableString spannableString = new SpannableString(" ");                spannableString.setSpan(imageSpan, 0, 1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);                return spannableString;            }            /**             * 在调用notifyDataSetChanged()方法后，随之会触发该方法，根据该方法返回的值来确定是否更新             * object对象为Fragment，具体是当前显示的Fragment和它的前一个以及后一个             */            @Override            public int getItemPosition(Object object) {                if(object.getClass().getName().equals(SecondFragment.class.getName())){                    return POSITION_NONE;                }                return super.getItemPosition(object);            }        };    }    private void initView(){        viewPager = (ViewPager) findViewById(R.id.viewpager);        viewPager.setAdapter(pagerAdapter);    }    private void initTabLayout(){        tabLayout = (TabLayout) findViewById(R.id.tablayout);        tabLayout.setupWithViewPager(viewPager);    }    private void initDB(){        sqLiteOpenHelper = new MyDatabaseHelper(this, "SugarStore.db", null, 1);        sqLiteOpenHelper.getWritableDatabase();    }}